# 문제 4

아래의 요구조건에 맞는 설계를 진행하고, 이유를 설명해주세요

작은 스타트업에서 BO 서비스에서 통계 서비스를 개발하여 합니다

1. 각 콘텐츠의 유저의 클릭수, 좋아요수를 보여주는 그래프를 그려야 합니다
2. 클릭과 좋아요 수는 BO의 대시보드에서 확인이 가능하며, 새로고침 버튼을 눌러서 갱신 가능합니다
3. 그래프는 일일 단위로 합계로 표시됩니다
  ------
1. 요구사항 분석  
- 각 유저의 클릭 수, 좋아요 수를 기록하고 그래프로 제공  
    - 각 콘텐츠 별 클릭, 좋아요 수를 DB에 저장  
    - 일별 집계된 데이터 제공  
- BO 대시보드에서 새로고침 버튼으로 최신 데이터 조회 가능  
    - 실시간으로 저장된 데이터를 빠르게 조회 가능해야 함  
    - 백엔드 API를 통해 데이터를 제공  
- 그래프는 일일 단위로 합계 표시  
    - 하루 단위의 합산 데이터 사용  
    - 매일 정해진 시간에 배치 작업을 수행하여 데이터를 집계  
  
2. 시스템 설계  
- 데이터를 수집하는 과정과 조회하는 과정 분리  
- 실시간 저장과 일일 집계를 분리  
- 데이터가 쌓이므로 저장 방식을 효율적으로 구현 필요  
  
- 실시간 이벤트 저장  
    - 사용자가 클릭, 좋아요 이벤트를 발생시키면 DB, Redis에 기록  
    - 저장은 실시간으로, 조회는 집계된 데이터를 사용  
- 일일 단위 집계  
    - 매일 배치 프로세스를 통해 각 콘텐츠의 클릭 수, 좋아요 수를 집계  
    - 기존 데이터와 중복 저장을 방지하기 위해 UPSERT(UPDATE + INSERT) 방식 사용  
- 대시보드 API  
    - 집계된 데이터를 API로 제공  
    - 빠른 응답 속도를 위해 인덱스나 캐싱 적용  
  
3. 데이터 모델 설계  
- 이벤트 로그 테이블  
    - 개별 클릭 및 좋아요 이벤트를 기록하는 테이블  
    - 이벤트 중복 방지를 위해 Unique 키 또는 Redis 활용  
    - 빠른 조회를 위해 파티셔닝 활용 고려해볼 수 있음  
    ![EVENT LOG TABLE](./assets/tables/event_log_table.png)  
  
- 집계 테이블  
    - 하루 단위로 집계된 데이터를 저장하는 테이블  
    - 조회 성능을 고려해서 인덱스 설정 (콘텐츠 ID + 날짜)  
    ![DAILY EVENT SUMMARY TABLE](./assets/tables/daily_event_summary_table.png)  
  
4. API 설계  
![API DESCRIPTION](./assets/API/API.png)  
  
5. 데이터 집계 및 조회 최적화  
- 일일 단위 통계 집계 방식  
    - 하루동안 발생한 클릭, 좋아요 이벤트를 집계하여 배치 작업으로 집계 테이블에 저장  
    - ON DUPLICATE KEY UPDATE 또는 MERGE 를 사용해서 중복 삽입 방지  
- 조회 속도 최적화  
    - 자주 조회되는 데이터를 캐싱처리  
    - 인덱싱으로 최적화해서 빠르게 조회할 수 있도록 설계  

---

### 💡 추가질문 1. - 실제로 구현해본 경험이 있다면, 해당 구현 경험을 서술해주세요

### 💡 추가질문 2. - 유저가 클릭을 조작하기위해 빠르게 연타를 한다면, 어떻게 방지할수 있을까요?
